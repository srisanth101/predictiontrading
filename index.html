<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Spidey TradeX</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * { margin:0; padding:0; box-sizing:border-box; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif; }
        body {
            background: linear-gradient(135deg, #0f0f1f 0%, #1a1a2e 50%, #16213e 100%);
            color:#fff; min-height:100vh; overflow:auto; position:relative;
        }
        .glass-effect {
            position:fixed; width:100%; height:100%;
            background:
                radial-gradient(circle at 20% 30%, rgba(0,122,255,0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(255,69,58,0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(50,215,75,0.1) 0%, transparent 50%);
            backdrop-filter: blur(40px); z-index:-1;
        }
        .background-image {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('https://images.unsplash.com/photo-1611974789855-9c2a0a7236a3?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80');
            background-size: cover;
            background-position: center;
            opacity: 0.5; /* 50% opacity */
            z-index: -2;
        }
        .container {
            width:100%; min-height:100vh; display:flex; flex-direction:column; padding:20px; position:relative; z-index:1;
            max-width:500px; margin:0 auto;
        }
        .header { display:flex; flex-direction:column; align-items:center; padding:10px 0; gap:10px; margin-bottom:10px; }
        .logo-container { width:100px; height:100px; border-radius:20px; overflow:hidden; box-shadow:0 8px 25px rgba(0,122,255,0.3); border:2px solid rgba(255,255,255,0.1); }
        .logo { width:100%; height:100%; object-fit:cover; }
        .app-name { font-size:28px; font-weight:800; background:linear-gradient(90deg,#007AFF,#FF453A); -webkit-background-clip:text; -webkit-text-fill-color:transparent; }
        .subtitle { color:#8E8E93; font-size:14px; text-align:center; }
        .social-links { display:flex; justify-content:center; gap:15px; margin-top:5px; }
        .social-link { color:#8E8E93; font-size:14px; text-decoration:none; transition:color 0.3s; }
        .social-link:hover { color:#007AFF; }
        .main-section { flex:1; display:flex; flex-direction:column; justify-content:center; align-items:center; text-align:center; margin:10px 0; }
        .prediction-card {
            background: rgba(255,255,255,0.1); backdrop-filter: blur(30px); border-radius:24px; padding:25px; width:100%;
            border:1px solid rgba(255,255,255,0.15); box-shadow:0 15px 35px rgba(0,0,0,0.3); margin-bottom:15px; position:relative; overflow:hidden;
        }
        .timer-section { margin-bottom:15px; }
        .timer-text { font-size:16px; color:#8E8E93; margin-bottom:8px; }
        .countdown { font-size:42px; font-weight:700; color:#007AFF; text-shadow:0 0 20px rgba(0,122,255,0.5); }
        .progress-container { width:100%; height:6px; background:rgba(255,255,255,0.1); border-radius:3px; overflow:hidden; margin:12px 0; }
        .progress-bar { height:100%; background:linear-gradient(90deg,#007AFF,#5856D6); width:0%; transition:width 1s linear; border-radius:3px; }
        .prediction-result { font-size:48px; font-weight:800; margin:15px 0; transition:all 0.5s ease; text-shadow:0 0 20px rgba(255,255,255,0.3); display:flex; justify-content:center; align-items:center; gap:12px; }
        .prediction-result .confidence { font-size:14px; font-weight:700; color:#fff; opacity:0.9; padding:6px 10px; border-radius:12px; background:rgba(0,0,0,0.18); border:1px solid rgba(255,255,255,0.06); }
        .buy { color:#32D74B; text-shadow:0 0 20px rgba(50,215,75,0.5); }
        .sell { color:#FF453A; text-shadow:0 0 20px rgba(255,69,58,0.5); }
        .analysis-section { background:rgba(255,255,255,0.08); backdrop-filter:blur(20px); border-radius:16px; padding:15px; margin-top:15px; text-align:left; border:1px solid rgba(255,255,255,0.1); }
        .analysis-title { font-size:14px; font-weight:600; margin-bottom:8px; color:#8E8E93; display:flex; align-items:center; gap:8px; }
        .analysis-text { font-size:13px; line-height:1.4; color:#fff; }
        .action-section { display:flex; flex-direction:column; gap:12px; padding:15px 0; width:100%; }
        .win-loss-buttons { display:flex; gap:12px; margin-bottom:8px; }
        .win-btn,.loss-btn { flex:1; padding:16px; border:none; border-radius:16px; font-size:16px; font-weight:600; cursor:pointer; transition:all 0.3s ease; display:flex; align-items:center; justify-content:center; gap:8px; backdrop-filter:blur(20px); box-shadow:0 8px 20px rgba(0,0,0,0.2); }
        .win-btn { background:rgba(50,215,75,0.15); color:#32D74B; border:1px solid rgba(50,215,75,0.3); }
        .win-btn:active { background:rgba(50,215,75,0.25); transform:scale(0.98); }
        .loss-btn { background:rgba(255,69,58,0.15); color:#FF453A; border:1px solid rgba(255,69,58,0.3); }
        .loss-btn:active { background:rgba(255,69,58,0.25); transform:scale(0.98); }
        .glow { animation:glowEffect 1.5s infinite alternate; box-shadow:0 0 25px currentColor; }
        .next-btn { background:linear-gradient(90deg,#007AFF,#5856D6); color:white; border:none; border-radius:16px; padding:16px; font-size:16px; font-weight:600; cursor:pointer; transition:all 0.3s ease; box-shadow:0 8px 25px rgba(0,122,255,0.4); display:flex; align-items:center; justify-content:center; gap:8px; backdrop-filter:blur(20px); }
        .next-btn:active { transform:scale(0.98); }
        .next-btn:disabled { background:rgba(255,255,255,0.1); color:rgba(255,255,255,0.3); cursor:not-allowed; transform:none; box-shadow:0 8px 20px rgba(0,0,0,0.1); }
        .history-btn { background:rgba(255,255,255,0.1); color:white; border:none; border-radius:16px; padding:14px; font-size:14px; font-weight:600; cursor:pointer; transition:all 0.3s ease; display:flex; align-items:center; justify-content:center; gap:8px; backdrop-filter:blur(20px); border:1px solid rgba(255,255,255,0.1); margin-top:5px; }
        .history-btn:active { transform:scale(0.98); background:rgba(255,255,255,0.15); }
        .stats { display:flex; justify-content:space-around; width:100%; margin:15px 0; }
        .stat-item { text-align:center; background:rgba(255,255,255,0.08); backdrop-filter:blur(20px); padding:12px; border-radius:16px; flex:1; margin:0 4px; border:1px solid rgba(255,255,255,0.1); }
        .stat-value { font-size:18px; font-weight:700; margin-bottom:4px; }
        .stat-label { font-size:11px; color:#8E8E93; }
        .history-modal { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); backdrop-filter:blur(10px); display:flex; justify-content:center; align-items:center; z-index:100; opacity:0; visibility:hidden; transition:all 0.3s ease; }
        .history-modal.active { opacity:1; visibility:visible; }
        .history-content { background:rgba(30,30,40,0.95); backdrop-filter:blur(30px); border-radius:24px; padding:25px; width:90%; max-width:400px; max-height:70vh; overflow-y:auto; border:1px solid rgba(255,255,255,0.15); box-shadow:0 20px 40px rgba(0,0,0,0.4); }
        .history-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; padding-bottom:15px; border-bottom:1px solid rgba(255,255,255,0.1); }
        .history-title { font-size:20px; font-weight:700; background:linear-gradient(90deg,#007AFF,#FF453A); -webkit-background-clip:text; -webkit-text-fill-color:transparent; }
        .close-history { background:none; border:none; color:#8E8E93; font-size:20px; cursor:pointer; padding:5px; }
        .history-list { display:flex; flex-direction:column; gap:12px; }
        .history-item { background:rgba(255,255,255,0.08); backdrop-filter:blur(20px); border-radius:12px; padding:15px; border:1px solid rgba(255,255,255,0.1); display:flex; justify-content:space-between; align-items:center; }
        .history-info { display:flex; flex-direction:column; gap:5px; }
        .history-prediction { font-size:16px; font-weight:600; }
        .history-time { font-size:12px; color:#8E8E93; }
        .history-result { padding:6px 12px; border-radius:20px; font-size:12px; font-weight:600; }
        .history-win { background:rgba(50,215,75,0.2); color:#32D74B; }
        .history-loss { background:rgba(255,69,58,0.2); color:#FF453A; }
        .empty-history { text-align:center; color:#8E8E93; padding:30px 0; font-style:italic; }
        .hidden { display:none; }
        .fade-in { animation:fadeIn 0.5s ease; }
        .zoom-in { animation:zoomIn 0.5s ease; }
        .pulse { animation:pulse 2s infinite; }
        
        /* Login Page Styles */
        .login-container { width:100%; min-height:100vh; display:flex; flex-direction:column; padding:20px; position:relative; z-index:1; max-width:500px; margin:0 auto; }
        .login-header { display:flex; flex-direction:column; align-items:center; padding:10px 0; gap:10px; margin-bottom:30px; }
        .login-title { font-size:24px; font-weight:700; margin-bottom:10px; text-align:center; }
        .login-subtitle { color:#8E8E93; font-size:14px; text-align:center; margin-bottom:30px; }
        .login-card { background: rgba(255,255,255,0.1); backdrop-filter: blur(30px); border-radius:24px; padding:25px; width:100%; border:1px solid rgba(255,255,255,0.15); box-shadow:0 15px 35px rgba(0,0,0,0.3); }
        .login-step { display:flex; flex-direction:column; gap:20px; }
        .input-group { margin-bottom:20px; }
        .input-label { font-size:14px; color:#8E8E93; margin-bottom:8px; display:block; }
        .input-field { width:100%; padding:16px; border-radius:12px; background:rgba(255,255,255,0.08); border:1px solid rgba(255,255,255,0.1); color:white; font-size:16px; }
        .input-field:focus { outline:none; border-color:#007AFF; }
        .login-btn { background:linear-gradient(90deg,#007AFF,#5856D6); color:white; border:none; border-radius:16px; padding:16px; font-size:16px; font-weight:600; cursor:pointer; transition:all 0.3s ease; box-shadow:0 8px 25px rgba(0,122,255,0.4); width:100%; margin-top:10px; }
        .login-btn:active { transform:scale(0.98); }
        .login-btn:disabled { background:rgba(255,255,255,0.1); color:rgba(255,255,255,0.3); cursor:not-allowed; transform:none; box-shadow:0 8px 20px rgba(0,0,0,0.1); }
        .error-message { color:#FF453A; font-size:14px; text-align:center; margin-top:10px; display:none; }
        
        /* DeepSeek Theme Enhancements */
        .deepseek-theme {
            background: linear-gradient(135deg, #0f0f1f 0%, #1a1a2e 50%, #16213e 100%);
        }
        
        .deepseek-theme .app-name {
            background: linear-gradient(90deg, #00D4FF, #0099FF);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .deepseek-theme .countdown {
            color: #00D4FF;
            text-shadow: 0 0 20px rgba(0, 212, 255, 0.5);
        }
        
        .deepseek-theme .next-btn {
            background: linear-gradient(90deg, #00D4FF, #0099FF);
            box-shadow: 0 8px 25px rgba(0, 212, 255, 0.4);
        }
        
        .deepseek-theme .history-title {
            background: linear-gradient(90deg, #00D4FF, #0099FF);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .deepseek-theme .login-btn {
            background: linear-gradient(90deg, #00D4FF, #0099FF);
            box-shadow: 0 8px 25px rgba(0, 212, 255, 0.4);
        }
        
        .deepseek-theme .input-field:focus {
            border-color: #00D4FF;
        }
        
        .deepseek-theme .progress-bar {
            background: linear-gradient(90deg, #00D4FF, #0099FF);
        }
        
        @keyframes fadeIn { from { opacity:0; } to { opacity:1; } }
        @keyframes zoomIn { from { transform:scale(0.8); opacity:0; } to { transform:scale(1); opacity:1; } }
        @keyframes pulse { 0%{ transform:scale(1);} 50%{ transform:scale(1.05);} 100%{ transform:scale(1);} }
        @keyframes glowEffect { from { box-shadow:0 0 10px currentColor; } to { box-shadow:0 0 25px currentColor, 0 0 35px currentColor; } }
        
        /* Mobile-specific optimizations */
        @media (max-width:400px) {
            .container, .login-container { padding:15px; }
            .prediction-result { font-size:36px; flex-direction: column; gap: 8px; }
            .countdown { font-size:36px; }
            .win-btn,.loss-btn,.next-btn { padding:14px; font-size:14px; }
            .stat-item { padding:10px 6px; }
            .stat-value { font-size:16px; }
            .login-card { padding: 20px; }
            .prediction-card { padding: 20px; }
            .prediction-result .confidence { font-size: 12px; }
        }
        
        @media (max-height:700px) {
            .login-header { margin-bottom: 15px; }
            .login-subtitle { margin-bottom: 15px; }
            .main-section { justify-content: flex-start; }
            .prediction-card { margin-bottom: 10px; }
            .stats { margin: 10px 0; }
        }
        
        /* Touch-friendly improvements */
        button, .option-card, .currency-item {
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }
        
        /* Prevent zoom on input focus for iOS */
        @media (max-width: 500px) {
            input, select, textarea {
                font-size: 16px !important;
            }
        }
    </style>
</head>
<body class="deepseek-theme">
    <div class="background-image"></div>
    <div class="glass-effect"></div>

    <!-- Login Page -->
    <div class="login-container" id="loginContainer">
        <div class="login-header">
            <div class="logo-container">
                <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgYf279bKwPb7jsJhBjXyn2fGBTrFEUwvinVceLlhj4UWzIF4Zw8XQMPw9Z2QVRYI20a0ejXwub5Dx9tLbT7KkJrCWJTSlkLFAXkDP9AXRRNuSF5xcWwF3GN1GiDXUMYBZJbRSiECAt3Qwqkbnq9QMAtCLUt5EkFuPOkTG3q-X9UB5CRugdhhnXxjmINvo/s1024/ChatGPT%20Image%20Oct%206,%202025,%2012_27_58%20PM.png" alt="Spidey TradeX Logo" class="logo">
            </div>
            <div class="app-name">Spidey TradeX</div>
            <div class="subtitle">AI-Powered Trading Predictions</div>
            <div class="social-links">
                <a href="#" class="social-link" target="_blank">
                    <i class="fab fa-telegram"></i> Telegram
                </a>
                <a href="#" class="social-link" target="_blank">
                    <i class="fab fa-instagram"></i> Instagram
                </a>
                <a href="#" class="social-link" target="_blank">
                    <i class="fab fa-youtube"></i> YouTube
                </a>
            </div>
        </div>

        <!-- Login Form -->
        <div class="login-card" id="loginForm">
            <div class="login-title">Access Spidey TradeX</div>
            <div class="login-subtitle">Enter your UID and Key to continue</div>
            
            <div class="login-step">
                <div class="input-group">
                    <label class="input-label">UID</label>
                    <input type="text" class="input-field" id="userUID" placeholder="Enter your UID" inputmode="numeric">
                </div>
                
                <div class="input-group">
                    <label class="input-label">Key</label>
                    <input type="password" class="input-field" id="userKey" placeholder="Enter your key">
                    <div class="error-message" id="loginError">Invalid UID or Key. Please check your credentials.</div>
                </div>
                
                <button class="login-btn" id="loginBtn">Login <i class="fas fa-sign-in-alt"></i></button>
            </div>
        </div>
    </div>

    <!-- Main App (Hidden Initially) -->
    <div class="container hidden" id="mainApp">
        <div class="header">
            <div class="logo-container">
                <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgYf279bKwPb7jsJhBjXyn2fGBTrFEUwvinVceLlhj4UWzIF4Zw8XQMPw9Z2QVRYI20a0ejXwub5Dx9tLbT7KkJrCWJTSlkLFAXkDP9AXRRNuSF5xcWwF3GN1GiDXUMYBZJbRSiECAt3Qwqkbnq9QMAtCLUt5EkFuPOkTG3q-X9UB5CRugdhhnXxjmINvo/s1024/ChatGPT%20Image%20Oct%206,%202025,%2012_27_58%20PM.png" alt="Spidey TradeX Logo" class="logo">
            </div>
            <div class="app-name">Spidey TradeX</div>
            <div class="subtitle">AI-Powered Trading Predictions</div>
            <div class="social-links">
                <a href="#" class="social-link" target="_blank">
                    <i class="fab fa-telegram"></i> Telegram
                </a>
                <a href="#" class="social-link" target="_blank">
                    <i class="fab fa-instagram"></i> Instagram
                </a>
                <a href="#" class="social-link" target="_blank">
                    <i class="fab fa-youtube"></i> YouTube
                </a>
            </div>
        </div>

        <div class="main-section">
            <div class="prediction-card">
                <div class="timer-section">
                    <div class="timer-text">Next prediction in:</div>
                    <div class="countdown">15</div>
                    <div class="progress-container">
                        <div class="progress-bar"></div>
                    </div>
                </div>

                <div class="prediction-result">
                    <span class="prediction-label">Ready to Start</span>
                </div>

                <div class="analysis-section hidden" id="analysisSection">
                    <div class="analysis-title">
                        <i class="fas fa-robot"></i> AI Analysis:
                    </div>
                    <div class="analysis-text" id="analysisText">Click Start to see the first prediction</div>
                </div>
            </div>

            <div class="stats">
                <div class="stat-item">
                    <div class="stat-value" id="buyCount">0</div>
                    <div class="stat-label">BUY</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="sellCount">0</div>
                    <div class="stat-label">SELL</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="winCount">0</div>
                    <div class="stat-label">WINS</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="lossCount">0</div>
                    <div class="stat-label">LOSSES</div>
                </div>
            </div>
        </div>

        <div class="action-section">
            <div class="win-loss-buttons hidden" id="winLossButtons">
                <button class="win-btn" id="winBtn"><i class="fas fa-check-circle"></i> Win</button>
                <button class="loss-btn" id="lossBtn"><i class="fas fa-times-circle"></i> Loss</button>
            </div>

            <button id="startBtn" class="next-btn pulse"><i class="fas fa-play"></i> Start Prediction</button>
            <button id="nextBtn" class="next-btn hidden" disabled><i class="fas fa-redo"></i> Next Prediction</button>
            <button id="historyBtn" class="history-btn"><i class="fas fa-history"></i> View History</button>
        </div>
    </div>

    <!-- History Modal -->
    <div class="history-modal" id="historyModal">
        <div class="history-content">
            <div class="history-header">
                <div class="history-title">Trading History</div>
                <button class="close-history" id="closeHistory"><i class="fas fa-times"></i></button>
            </div>
            <div class="history-list" id="historyList">
                <div class="empty-history">No trading history yet</div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Check if user is already logged in
            const savedUserData = localStorage.getItem('spideyTradeXUser');
            if (savedUserData) {
                const userData = JSON.parse(savedUserData);
                // Skip login and show main app
                document.getElementById('loginContainer').classList.add('hidden');
                document.getElementById('mainApp').classList.remove('hidden');
                
                // Set user data in the app
                window.userUIDValue = userData.uid;
                
                // Load trading history if exists
                const savedHistory = localStorage.getItem('spideyTradeXHistory');
                if (savedHistory) {
                    tradeHistory = JSON.parse(savedHistory);
                    updateHistoryDisplay();
                }
                
                // Load stats if exists
                const savedStats = localStorage.getItem('spideyTradeXStats');
                if (savedStats) {
                    const stats = JSON.parse(savedStats);
                    buyCount = stats.buyCount || 0;
                    sellCount = stats.sellCount || 0;
                    winCount = stats.winCount || 0;
                    lossCount = stats.lossCount || 0;
                    
                    // Update stats display
                    buyCountElement.textContent = buyCount;
                    sellCountElement.textContent = sellCount;
                    winCountElement.textContent = winCount;
                    lossCountElement.textContent = lossCount;
                }
            }
            
            // Login Elements
            const loginContainer = document.getElementById('loginContainer');
            const mainApp = document.getElementById('mainApp');
            const userUID = document.getElementById('userUID');
            const userKey = document.getElementById('userKey');
            const loginBtn = document.getElementById('loginBtn');
            const loginError = document.getElementById('loginError');
            
            // Valid UIDs and Key
            const validUIDs = ['123456789', '1221122112', '1010101010'];
            const validKey = 'SrisanthPrediction';
            
            // Main App Elements
            const startBtn = document.getElementById('startBtn');
            const nextBtn = document.getElementById('nextBtn');
            const winBtn = document.getElementById('winBtn');
            const lossBtn = document.getElementById('lossBtn');
            const historyBtn = document.getElementById('historyBtn');
            const closeHistory = document.getElementById('closeHistory');
            const historyModal = document.getElementById('historyModal');
            const historyList = document.getElementById('historyList');
            const winLossButtons = document.getElementById('winLossButtons');
            const countdownElement = document.querySelector('.countdown');
            const progressBar = document.querySelector('.progress-bar');
            const predictionResult = document.querySelector('.prediction-result');
            const analysisSection = document.getElementById('analysisSection');
            const analysisText = document.getElementById('analysisText');
            const buyCountElement = document.getElementById('buyCount');
            const sellCountElement = document.getElementById('sellCount');
            const winCountElement = document.getElementById('winCount');
            const lossCountElement = document.getElementById('lossCount');

            // Trading State
            let countdown;
            let timeLeft = 15;
            let buyCount = 0;
            let sellCount = 0;
            let winCount = 0;
            let lossCount = 0;
            let currentPrediction = null;
            let resultRecorded = false;
            let tradeHistory = [];
            
            // Login Functionality
            loginBtn.addEventListener('click', function() {
                const uidValue = userUID.value.trim();
                const keyValue = userKey.value.trim();
                
                // Check if UID and Key are valid
                if (validUIDs.includes(uidValue) && keyValue === validKey) {
                    loginError.style.display = 'none';
                    
                    // Save user data to localStorage
                    const userData = {
                        uid: uidValue
                    };
                    localStorage.setItem('spideyTradeXUser', JSON.stringify(userData));
                    
                    // Hide login, show main app
                    loginContainer.classList.add('hidden');
                    mainApp.classList.remove('hidden');
                    
                    // Set user data in the app
                    window.userUIDValue = uidValue;
                } else {
                    loginError.style.display = 'block';
                }
            });
            
            // Auto-login when valid UID and Key are entered
            userUID.addEventListener('input', function() {
                const uidValue = userUID.value.trim();
                const keyValue = userKey.value.trim();
                
                if (validUIDs.includes(uidValue) && keyValue === validKey) {
                    loginError.style.display = 'none';
                    
                    // Save user data to localStorage
                    const userData = {
                        uid: uidValue
                    };
                    localStorage.setItem('spideyTradeXUser', JSON.stringify(userData));
                    
                    // Hide login, show main app
                    loginContainer.classList.add('hidden');
                    mainApp.classList.remove('hidden');
                    
                    // Set user data in the app
                    window.userUIDValue = uidValue;
                }
            });
            
            userKey.addEventListener('input', function() {
                const uidValue = userUID.value.trim();
                const keyValue = userKey.value.trim();
                
                if (validUIDs.includes(uidValue) && keyValue === validKey) {
                    loginError.style.display = 'none';
                    
                    // Save user data to localStorage
                    const userData = {
                        uid: uidValue
                    };
                    localStorage.setItem('spideyTradeXUser', JSON.stringify(userData));
                    
                    // Hide login, show main app
                    loginContainer.classList.add('hidden');
                    mainApp.classList.remove('hidden');
                    
                    // Set user data in the app
                    window.userUIDValue = uidValue;
                }
            });

            // Helper: format confidence visually (two numbers sum to 100)
            function generateConfidence(isBuy) {
                // base random confidence, skew slightly toward the predicted side
                const base = Math.floor(Math.random() * 21) + 55; // 55..75
                if (isBuy) return { buy: base, sell: 100 - base };
                return { buy: 100 - base, sell: base };
            }

            // Start the prediction process
            startBtn.addEventListener('click', function() {
                startBtn.classList.add('hidden');
                nextBtn.classList.remove('hidden');
                winLossButtons.classList.remove('hidden');
                startTimer();
                showPrediction();
            });

            // Next prediction button
            nextBtn.addEventListener('click', function() {
                if (resultRecorded) {
                    nextBtn.disabled = true;
                    resultRecorded = false;
                    winBtn.disabled = false;
                    lossBtn.disabled = false;
                    winBtn.classList.remove('glow');
                    lossBtn.classList.remove('glow');
                    startTimer();
                    showPrediction();
                }
            });

            // Win button
            winBtn.addEventListener('click', function() {
                if (currentPrediction && !resultRecorded) {
                    winCount++;
                    resultRecorded = true;
                    nextBtn.disabled = false;
                    winBtn.disabled = true;
                    lossBtn.disabled = true;

                    // Add to history
                    addToHistory(currentPrediction, true);

                    // Update analysis with win result
                    analysisText.textContent = generateAnalysis(currentPrediction.isBuy, true);

                    // Update stats
                    winCountElement.textContent = winCount;
                    
                    // Save stats to localStorage
                    saveStats();
                }
            });

            // Loss button
            lossBtn.addEventListener('click', function() {
                if (currentPrediction && !resultRecorded) {
                    lossCount++;
                    resultRecorded = true;
                    nextBtn.disabled = false;
                    winBtn.disabled = true;
                    lossBtn.disabled = true;

                    // Add to history
                    addToHistory(currentPrediction, false);

                    // Update analysis with loss result
                    analysisText.textContent = generateAnalysis(currentPrediction.isBuy, false);

                    // Update stats
                    lossCountElement.textContent = lossCount;
                    
                    // Save stats to localStorage
                    saveStats();
                }
            });

            // History button
            historyBtn.addEventListener('click', function() {
                historyModal.classList.add('active');
            });

            // Close history modal
            closeHistory.addEventListener('click', function() {
                historyModal.classList.remove('active');
            });

            // Close history modal when clicking outside
            historyModal.addEventListener('click', function(e) {
                if (e.target === historyModal) {
                    historyModal.classList.remove('active');
                }
            });

            function startTimer() {
                clearInterval(countdown);
                timeLeft = 15;
                updateTimer();
                countdown = setInterval(function() {
                    timeLeft--;
                    updateTimer();

                    if (timeLeft <= 5 && timeLeft > 0) {
                        // Start glowing effect when 5 seconds left
                        winBtn.classList.add('glow');
                        lossBtn.classList.add('glow');
                    }

                    if (timeLeft <= 0) {
                        clearInterval(countdown);
                        winBtn.classList.remove('glow');
                        lossBtn.classList.remove('glow');
                    }
                }, 1000);
            }

            function updateTimer() {
                countdownElement.textContent = timeLeft;
                progressBar.style.width = `${(15 - timeLeft) / 15 * 100}%`;
            }

            function showPrediction() {
                // Generate random buy/sell prediction
                const isBuy = Math.random() > 0.5;
                const prediction = isBuy ? "BUY" : "SELL";
                const predictionClass = isBuy ? "buy" : "sell";

                // Generate confidence
                const conf = generateConfidence(isBuy);

                // Update stats counters
                if (isBuy) buyCount++;
                else sellCount++;

                // Store current prediction
                currentPrediction = { isBuy, prediction, confidence: conf };

                // Update UI with prediction and confidence
                const label = document.createElement('span');
                label.className = 'prediction-label';
                label.textContent = prediction;

                const confSpan = document.createElement('span');
                confSpan.className = 'confidence';
                confSpan.innerHTML = `${conf.buy}% BUY • ${conf.sell}% SELL`;

                // Clear and append
                predictionResult.innerHTML = '';
                predictionResult.appendChild(label);
                predictionResult.appendChild(confSpan);

                predictionResult.className = `prediction-result ${predictionClass} zoom-in`;

                // Show analysis
                analysisSection.classList.remove('hidden');
                analysisText.textContent = generateAnalysis(isBuy, null);

                // Update stats display
                buyCountElement.textContent = buyCount;
                sellCountElement.textContent = sellCount;
                
                // Save stats to localStorage
                saveStats();

                // Add visual feedback to card border
                const card = document.querySelector('.prediction-card');
                card.style.borderColor = isBuy ? "rgba(50,215,75,0.3)" : "rgba(255,69,58,0.3)";

                // Reset border color after animation
                setTimeout(() => {
                    card.style.borderColor = "rgba(255, 255, 255, 0.15)";
                }, 1800);
            }

            function addToHistory(prediction, isWin) {
                const now = new Date();
                const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });

                const historyItem = {
                    prediction: prediction.prediction,
                    isBuy: prediction.isBuy,
                    isWin: isWin,
                    time: timeString,
                    confidence: prediction.confidence,
                    uid: window.userUIDValue
                };

                tradeHistory.unshift(historyItem);
                updateHistoryDisplay();
                
                // Save history to localStorage
                localStorage.setItem('spideyTradeXHistory', JSON.stringify(tradeHistory));
            }

            function updateHistoryDisplay() {
                if (tradeHistory.length === 0) {
                    historyList.innerHTML = '<div class="empty-history">No trading history yet</div>';
                    return;
                }

                historyList.innerHTML = '';
                tradeHistory.forEach(item => {
                    const historyItem = document.createElement('div');
                    historyItem.className = 'history-item';

                    const confText = item.confidence ? `<div style="font-size:12px;color:#8E8E93">${item.confidence.buy}% BUY • ${item.confidence.sell}% SELL</div>` : '';
                    const userInfo = `<div style="font-size:11px;color:#8E8E93">UID: ${item.uid}</div>`;

                    historyItem.innerHTML = `
                        <div class="history-info">
                            <div class="history-prediction">${item.prediction}</div>
                            ${confText}
                            ${userInfo}
                            <div class="history-time">${item.time}</div>
                        </div>
                        <div class="history-result ${item.isWin ? 'history-win' : 'history-loss'}">
                            ${item.isWin ? 'WIN' : 'LOSS'}
                        </div>
                    `;

                    historyList.appendChild(historyItem);
                });
            }
            
            function saveStats() {
                const stats = {
                    buyCount,
                    sellCount,
                    winCount,
                    lossCount
                };
                localStorage.setItem('spideyTradeXStats', JSON.stringify(stats));
            }

            function generateAnalysis(isBuy, isWin) {
                const buyAnalyses = [
                    "Strong bullish momentum detected with RSI showing oversold bounce potential. Volume spike confirms institutional accumulation.",
                    "Price action forming higher lows with MACD about to cross bullish. Support level holding strong with decreasing selling pressure.",
                    "AI pattern recognition identifies classic bull flag formation with 82% historical accuracy for upward breakout.",
                    "Market sentiment positive; fear/greed index leaning toward greed. Consider long entry with tight stop.",
                    "Fibonacci retracement shows price at 61.8% level with strong bounce expected; buy walls observed on orderbook."
                ];

                const sellAnalyses = [
                    "Bearish divergence spotted on RSI with momentum fading—distribution pattern detected.",
                    "Resistance level holding with multiple rejection wicks; upside struggling without volume confirmation.",
                    "AI detects head-and-shoulders formation near completion; downside projection possible.",
                    "Market sentiment turning cautious; put/call ratio rising and net selling by larger accounts.",
                    "Price rejected at moving average confluence; stochastic shows overbought crossover."
                ];

                const buyWin = [
                    "Excellent call! Breakout confirmed—AI pattern success rate improving for this setup.",
                    "Buy prediction validated by strong volume; institutional inflow detected, trade was a WIN.",
                    "Price surged as forecasted—momentum followed through perfectly and trade closed in profit."
                ];

                const buyLoss = [
                    "Unexpected volatility led to stop-loss; setup likely invalidated by a large sell order.",
                    "Minor retracement turned deeper than expected—loss recorded, trend may resume soon.",
                    "False breakout—volume spike lacked continuation, resulting in a LOSS for this signal."
                ];

                const sellWin = [
                    "Bearish thesis played out; resistance rejection triggered downside momentum—trade was a WIN.",
                    "Sell signal confirmed by volume and orderflow; downside captured as forecasted.",
                    "Perfect short setup: resistance + divergence, trade closed profitably."
                ];

                const sellLoss = [
                    "Short squeeze pushed price higher unexpectedly—stop-loss triggered before reversal.",
                    "Momentum reversed quickly; bearish signal invalidated on higher timeframe.",
                    "Unexpected bullish catalyst appeared; loss recorded, model adapting to new info."
                ];

                // Return analysis based on state
                if (isBuy && isWin === true) return buyWin[Math.floor(Math.random() * buyWin.length)];
                if (isBuy && isWin === false) return buyLoss[Math.floor(Math.random() * buyLoss.length)];
                if (!isBuy && isWin === true) return sellWin[Math.floor(Math.random() * sellWin.length)];
                if (!isBuy && isWin === false) return sellLoss[Math.floor(Math.random() * sellLoss.length)];
                return isBuy ? buyAnalyses[Math.floor(Math.random() * buyAnalyses.length)]
                             : sellAnalyses[Math.floor(Math.random() * sellAnalyses.length)];
            }
        });
    </script>
</body>
</html>
